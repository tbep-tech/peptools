<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Dissolved Oxygen • peptools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dissolved Oxygen">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">peptools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/dissolvedoxygen.html">Dissolved Oxygen</a></li>
    <li><a class="dropdown-item" href="../articles/pathogens.html">Beach Pathogens</a></li>
    <li><a class="dropdown-item" href="../articles/figures.html">Figures</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Dissolved Oxygen</h1>
            
      

      <div class="d-none name"><code>dissolvedoxygen.Rmd</code></div>
    </div>

    
    
<p>This vignette describes summarizing and reporting dissolved oxygen
(DO) data for the Peconic Estuary. Three continuous USGS monitoring
stations collect DO data at locations in the Peconic Estuary: USGS
stations 01304562 in the Peconic River, 01304200 in Orient Harbor, and
01304650 in Shelter Island Sound. Data at these stations can be
downloaded using the <code><a href="../reference/read_pepdo.html">read_pepdo()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_pepdo.html">read_pepdo</a></span><span class="op">(</span>site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'01304562'</span>, <span class="st">'01304200'</span>, <span class="st">'01304650'</span><span class="op">)</span>, </span>
<span>                    nms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Peconic River'</span>, <span class="st">'Orient Harbor'</span>, <span class="st">'Shelter Island'</span><span class="op">)</span>, </span>
<span>                    startDate <span class="op">=</span> <span class="st">'2020-06-01'</span>, endDate <span class="op">=</span> <span class="st">'2020-06-30'</span><span class="op">)</span></span></code></pre></div>
<p>The <code>dodat</code> data object included with the package provides
DO data from 2013 to 2024 at the three sites. This takes several minutes
to download using the <code><a href="../reference/read_pepdo.html">read_pepdo()</a></code> function, so it is
included with the package for ease of use.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dodat</span><span class="op">)</span></span>
<span><span class="co">#&gt;            site            DateTime do_mgl</span></span>
<span><span class="co">#&gt; 1 Orient Harbor 2013-01-01 00:00:00   11.2</span></span>
<span><span class="co">#&gt; 2 Orient Harbor 2013-01-01 00:06:00   11.2</span></span>
<span><span class="co">#&gt; 3 Orient Harbor 2013-01-01 00:12:00   11.2</span></span>
<span><span class="co">#&gt; 4 Orient Harbor 2013-01-01 00:18:00   11.2</span></span>
<span><span class="co">#&gt; 5 Orient Harbor 2013-01-01 00:24:00   11.2</span></span>
<span><span class="co">#&gt; 6 Orient Harbor 2013-01-01 00:30:00   11.2</span></span></code></pre></div>
<p>A plot of the raw data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dodat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">DateTime</span>, y <span class="op">=</span> <span class="va">do_mgl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">4.8</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span>, colour <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span>, colour <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">site</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="st">'Dissolved oxygen (mg/L)'</span>, </span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    title <span class="op">=</span> <span class="st">'Dissolved oxygen at Orient Harbor, Peconic River, and Shelter Island'</span>, </span>
<span>    subtitle <span class="op">=</span> <span class="st">'Dashed lines are chronic and acute threhsolds (4.8, 3 mg/L)'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-4-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Dissolved oxygen data typically show daily and seasonal variation.
Summaries of condition should account for variation at both temporal
scales. Further, the impact of low dissolved oxygen concentrations on
biota can vary depending on both magnitude and duration of
hypoxia/anoxia. As such, condition assessment should consider how often
concentrations fall below a threshold and for how long. The assessments
below speak to each of these needs.</p>
<p>First, the data can be summarized from the continuous (~6 minute
observations) to daily averages using the <code>anlz_dodlpep()</code>
function. A user-specified threshold can be supplied to the
<code>thr</code> argument to summarize the data relative to a value of
interest, the default value being the acute threshold of 3 mg/L (an
alternative may be the chronic threshold of 4.8 mg/L, <span class="citation">[1]</span>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3 mg/l is acute, 4.8 mg/l is chronic</span></span>
<span><span class="va">dlysum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anlz_dodlypep.html">anlz_dodlypep</a></span><span class="op">(</span><span class="va">dodat</span>, thr <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">dlysum</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9,601 × 7</span></span></span>
<span><span class="co">#&gt;    site          Date          yr    mo do_mgl below below_cumsum</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Peconic River 2013-01-01  <span style="text-decoration: underline;">2</span>013     1   11.0     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Peconic River 2013-01-02  <span style="text-decoration: underline;">2</span>013     1   11.3     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Peconic River 2013-01-03  <span style="text-decoration: underline;">2</span>013     1   11.6     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Peconic River 2013-01-04  <span style="text-decoration: underline;">2</span>013     1   11.6     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Peconic River 2013-01-05  <span style="text-decoration: underline;">2</span>013     1   11.7     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Peconic River 2013-01-06  <span style="text-decoration: underline;">2</span>013     1   11.8     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Peconic River 2013-01-07  <span style="text-decoration: underline;">2</span>013     1   12.0     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Peconic River 2013-01-08  <span style="text-decoration: underline;">2</span>013     1   12.1     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Peconic River 2013-01-09  <span style="text-decoration: underline;">2</span>013     1   12.0     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Peconic River 2013-01-10  <span style="text-decoration: underline;">2</span>013     1   11.7     0            0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 9,591 more rows</span></span></span></code></pre></div>
<p>The last three columns show the daily summarized data. The
<code>do_mgl</code> column shows the average DO concentration for each
day, the <code>below</code> column shows a 1 (yes) or 0 (no) if the
concentration was below the threshold value at any point during a day,
and the <code>below_cumsum</code> column shows a cumulative tally of the
number of days in each month at which dissolved oxygen fell below the
threshold at any point during a day. By default, the
<code><a href="../reference/anlz_dodlypep.html">anlz_dodlypep()</a></code> function will impute missing daily
dissolved oxygen values to the average for the year, month, site
combination. This is often necessary to create summary values that make
sense. For example, if a month has incomplete data, the maximum
<code>below_cumsum</code> value will not show 30 or 31 days even if
every day in the observed record is below the threshold.</p>
<p>The data can also be summarized by month using the
<code><a href="../reference/anlz_domopep.html">anlz_domopep()</a></code> function. Summarizing by month distills the
information into a simple format for plotting. Internally, the
<code><a href="../reference/anlz_domopep.html">anlz_domopep()</a></code> function uses the
<code><a href="../reference/anlz_dodlypep.html">anlz_dodlypep()</a></code> function to first summarize results by day,
which are then summarized by month.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mosum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anlz_domopep.html">anlz_domopep</a></span><span class="op">(</span><span class="va">dodat</span>, thr <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">mosum</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 316 × 6</span></span></span>
<span><span class="co">#&gt;    site             yr mo    do_mgl below_ave below_maxrun</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Peconic River  <span style="text-decoration: underline;">2</span>013 Jan    11.6      0                0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Peconic River  <span style="text-decoration: underline;">2</span>013 Feb    11.9      0                0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Peconic River  <span style="text-decoration: underline;">2</span>013 Mar    11.7      0                0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Peconic River  <span style="text-decoration: underline;">2</span>013 Apr     9.55     0                0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Peconic River  <span style="text-decoration: underline;">2</span>013 May     7.90     0                0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Peconic River  <span style="text-decoration: underline;">2</span>013 Jun     5.73     0.3              5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Peconic River  <span style="text-decoration: underline;">2</span>013 Jul     3.12     0.871           11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Peconic River  <span style="text-decoration: underline;">2</span>013 Aug     3.13     0.774           15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Peconic River  <span style="text-decoration: underline;">2</span>013 Sep     4.81     0.633            6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Peconic River  <span style="text-decoration: underline;">2</span>013 Oct     6.03     0.258            7</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 306 more rows</span></span></span></code></pre></div>
<p>The last three columns show the monthly summarized data, where
<code>do_mgl</code> is the average of all daily DO averages across the
month, <code>below_ave</code> is the proportion of days in a month when
concentrations in a given day fell below the threshold (1 would mean all
days had an instance of DO below the threshold, 0 would mean none), and
<code>below_maxrun</code> is the maximum number of sequential days in a
month when concentrations in a given day fell below the threshold (30 or
31, depending on month, would indicate all days in a month had an
instance of DO below the threshold).</p>
<p>The <code>below_ave</code> and <code>below_maxrun</code> columns
summarize the DO data differently depending on how hypoxia/anoxia
conditions can be described relative to potential impacts on biological
resources. The <code>below_ave</code> column summarizes undersaturation
relative to only the number of times hypoxia conditions occurred,
whereas the <code>below_maxrun</code> column summarizes undersaturation
relative to both the number of instances and duration of hypoxia. In
other words, biota may be stressed differently depending on the number
of times hypoxia occurs vs how long it may persist. The two measures may
indicate similar information, but not always depending on
characteristics of the DO time series.</p>
<p>The summarized monthly data for a station can be plotted with the
<code><a href="../reference/show_domatrix.html">show_domatrix()</a></code> function. In this example, the default plot
shows the proportion of days in a month when concentrations in a given
day fell below a threshold of 3 mg/L for the Peconic River station.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_domatrix.html">show_domatrix</a></span><span class="op">(</span><span class="va">dodat</span>, site <span class="op">=</span> <span class="st">'Peconic River'</span>, thr <span class="op">=</span> <span class="fl">3</span>, show <span class="op">=</span> <span class="st">'below_ave'</span><span class="op">)</span></span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The maximum number of sequential days in a month when concentrations
in a given day fell below the threshold can also be plotted by changing
the <code>show</code> argument.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_domatrix.html">show_domatrix</a></span><span class="op">(</span><span class="va">dodat</span>, site <span class="op">=</span> <span class="st">'Peconic River'</span>, thr <span class="op">=</span> <span class="fl">3</span>, show <span class="op">=</span> <span class="st">'below_maxrun'</span><span class="op">)</span></span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The threshold can also be changed. For example, the chronic threshold
of 4.8 mg/L shows conditions relative to a more conservative
threshold.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_domatrix.html">show_domatrix</a></span><span class="op">(</span><span class="va">dodat</span>, site <span class="op">=</span> <span class="st">'Peconic River'</span>, thr <span class="op">=</span> <span class="fl">4.8</span>, show <span class="op">=</span> <span class="st">'below_ave'</span><span class="op">)</span></span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-9-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Plotting the results provides insights into hypoxia patterns at the
site depending on how under-saturated conditions were summarized.
Additional considerations may include:</p>
<ol style="list-style-type: decimal">
<li>Relevance of a threshold to biological indicator</li>
<li>Spatial extent of the indicators</li>
<li>Breakpoints for management decisions</li>
</ol>
<div id="refs" class="references csl-bib-body" entry-spacing="0">
<div id="ref-USEPA00" class="csl-entry">
<div class="csl-left-margin">[1] </div>
<div class="csl-right-inline">USEPA, Ambient aquatic life water quality
criteria for dissolved oxygen (saltwater): Cape cod to cape hatteras,
Office of Water, Office of Research; Development, US Environmental
Protection Agency, Washington, DC, 2000.</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcus Beck, Gerold Morrison, Holly Greening.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
